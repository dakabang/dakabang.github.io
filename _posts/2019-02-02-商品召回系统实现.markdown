## 基本概念
说起召回系统，我们首先得理解召回系统在什么场景下应用？以及在这些场景分别扮演什么样的角色？召回系统一般在搜索或者推荐系统中比较常见，主要目的是为了解决信息过载的问题，在很短时间内筛选出我们需要的结果，这就是召回系统的作用，举个例子，百度搜索”特朗普“，会搜索出很多特朗普的结果，如果第一页就有你想要的结果，说明这次的召回是很成功的；再举个例子，淘宝APP中你输入"年货"，淘宝便会推出一些大热的你可能喜欢的结果，如果推出来的结果你很喜欢，并且买了，给了好评，也说明是一次非常成功的召回。那么我们现在能够根据自己的语言描述一下什么是召回系统：召回系统是在很多个物品中找到满足预期的物品的系统。

## 什么时候需要召回系统
这个问题是了解召回系统的第一步，首先确定你是否需要它，召回系统的责任是解决信息过载，比如你在淘宝搜索”年货“，可能有几十万满足条件的商品，而用户只能在有限的时间里面查看很小一部分，这就需要召回系统解决两个问题，1.找到用户最可能买/最感兴趣的商品，缩小商品池子；2. 找到的池子一定要足够小，否则个性化排序将无法施展。举一个极端的例子，如果一款购物APP，只有1000个商品，就不需要召回系统了，直接排序就行了，下面就本人的实践，说一下一个商品召回系统怎么去做。

## 商品召回系统需要完成的功能
1. 能够根据输入条件检索物品，比如输入“年货”，能给出年货商品，输入“特朗普”，给出的是特朗普的百科和新闻等
2. 能够根据权重排序的功能，召回系统往往召回的是一批物品，通常量级虽然已经不是很大，但是对于用户来说也是无法全部接触到的（比如百度搜索，基本上看一页就不会往下翻了），因此排序就很重要，要是能给出热度比较高的，甚至是个性化的排序结果（后者比较难），那是极好的。
3. 支持业务的功能，商品召回系统不可避免需要完成一些用户UI的后台功能，比如价格折扣排序，销量排序，用户筛选等。
4. 实时更新的功能，包括物品信息和标签数据等等。

## 商品召回系统实现 
1. 首先说说非常重要的倒排索引，倒排是相对于正排来说的，正排就是通过文档ID找到文档相关信息

ID|颜色|款式|价格
:--:|:--:|:--:|:--:
101|红色|女款|100
102|蓝色|男款|100

可以理解正排就是数据库里面的一条条记录，倒排则是从属性维度出发的键值对，key就是属性，val就是满足属性的文档ID集合，像这样

属性|文档ID
:--:|:--:
颜色 红色 | 101
颜色 蓝色 | 102
款式 女款 | 101
款式 男款 | 102
价格 100 | 101，102

倒排的作用就是通过属性快速匹配，比如需要男款蓝色的衣服，就可以把第二个属性和第四个属性求交集就行了，得到结果为101，那么求交集这个过程可以使用什么算法呢？
1. skip list: 跳跃list，跳跃list是用空间换时间的方式，具体可搜索相关资料，这里不再做介绍
2. bitset: bitset是非常高效的一种与或非计算数据结构，bitset的每个bit对应一个文档（位置相关），每一个属性有一个bitset，如果对应位置的文档满足该属性，bit即为1，否则就是0